@echo off
title reverser
color 0f

echo "============Process List============"
powershell -nop -exec bypass Get-Process
echo "~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~"
set /p var="Enter Process PID #: "
echo "============Suspending Process ID %var%============"
lib\pssuspend.exe -accepteula %var%
ping 127.0.0.1 -n 2 > nul
echo "============Dumping Process Data of %var%============"
lib\pe-sieve.exe %var%
ping 127.0.0.1 -n 2 > nul
lib\pe-sieve.exe %var% /shellc
ping 127.0.0.1 -n 2 > nul

echo "============Confirming if Data Dump of %var% was successful============"
set errorlevel=process_%var%
IF EXIST %ERRORLEVEL% echo Data Successfully Dumped
dir /b process_%var%

set /p var2="Analyze Process %var% (y/n)?: "
IF %var2% == 'y' GOTO analyze
IF %var2% == 'Y' GOTO analyze
IF %var2% == 'n' GOTO exit
IF %var2% == 'N' GOTO exit

:analyze
start "PE-bear.exe" process_%var%\*.dll process_%var%\*.shc
pause

set /p var3="Resume Process %var% (1), Kill Process (2) or Exit (3)?"
IF %var3% == '1' GOTO resume
IF %var3% == '2' GOTO kill
IF %var3% == '3' GOTO exit

:resume
lib\pssuspend.exe -accepteula -r %var%

:kill
taskkill /pid %var% 

:exit
exit
