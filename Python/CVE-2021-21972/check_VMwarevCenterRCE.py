import requests

# Requires python3 due to the format string

print("""
        VMware vCenter RCE vulnerbility checker
""")

url = input('Enter domain/ip: ')

JsonHeader = {
        'User-Agent': 'Mozilla/5.0 (compatible; vCenter)'
}

ExpectedResponse = "Final Progress"
sess = requests.session()

resp = sess.get(f"http://{url}/ui/vropspluginui/rest/services/getstatus", headers=JsonHeader)

if ExpectedResponse in resp.content.decode():
        print("""
        Site is vulnerable to VMware vCenter RCE CVE-2021-21972.

        Please visit: https://www.vmware.com/security/advisories/VMSA-2021-0002.html for more information.""")
else:
        print("Site is not vulnerable to the exploit")